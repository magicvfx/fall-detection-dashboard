<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Fall Detection Alerts</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f9f9f9; padding:20px; }
    h1 { text-align:center; }
    .alert {
      background:#fff;
      padding:12px;
      margin:15px 0;
      border-radius:8px;
      box-shadow:0 2px 6px rgba(0,0,0,0.1);
    }
    .type { font-weight:bold; font-size:18px; }
    .map {
      width:100%;
      height:250px;
      margin-top:10px;
      border-radius:6px;
      overflow:hidden;
    }
  </style>
</head>
<body>
  <h1>🚨 Fall Detection Alerts</h1>
  <div id="alerts"></div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

  <script>
    // 🔑 Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyCoSb7TW3Wgz5zzWVajpk2l8DqFKYEK-3o",
      authDomain: "fall-dectation.firebaseapp.com",
      databaseURL: "https://fall-dectation-default-rtdb.firebaseio.com",
      projectId: "fall-dectation",
      storageBucket: "fall-dectation.firebasestorage.app",
      messagingSenderId: "467192692594",
      appId: "1:467192692594:web:2756ad46d7d1fbb210e7eb"
    };
    firebase.initializeApp(firebaseConfig);

    const alertsRef = firebase.database().ref("alerts");

    alertsRef.on("child_added", snap => {
      const data = snap.val();
      const container = document.createElement("div");
      container.className = "alert";
      
      // Google Maps iframe
      const mapFrame = `
        <div class="map">
          <iframe 
            width="100%" height="100%" frameborder="0" style="border:0"
            src="https://www.google.com/maps?q=${data.lat},${data.lng}&z=16&output=embed"
            allowfullscreen>
          </iframe>
        </div>
      `;

      container.innerHTML = `
        <div class="type">⚡ ${data.type}</div>
        <div>📍 Lat: ${data.lat}, Lng: ${data.lng}</div>
        <div>🔋 Battery: ${parseFloat(data.battery).toFixed(2)} V</div>
        <div>🕒 ${data.time || "No time available"}</div>
        ${mapFrame}
      `;
      
      document.getElementById("alerts").prepend(container);
    });
  </script>
</body>
</html>
