<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Smart Fall Detection Alerts</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    h1 { color: #333; }
    #map { height: 400px; width: 100%; margin-top: 20px; border: 2px solid #444; border-radius: 10px; }
    .info { margin: 10px 0; font-size: 16px; }
    .alert-box { background: #f9f9f9; padding: 10px; border-radius: 8px; border: 1px solid #ccc; }
  </style>
</head>
<body>
  <h1>ðŸš¨ Fall Detection Alerts</h1>

  <div class="alert-box">
    <div class="info">Type: <span id="type">--</span></div>
    <div class="info">Latitude: <span id="lat">--</span></div>
    <div class="info">Longitude: <span id="lng">--</span></div>
    <div class="info">Battery: <span id="battery">--</span> V</div>
  </div>

  <div id="map"></div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

  <script>
    // ðŸ”¥ Your Firebase Config
    const firebaseConfig = {
      apiKey: "AIzaSyCoSb7TW3Wgz5zzWVajpk2l8DqFKYEK-3o",
      authDomain: "fall-dectation.firebaseapp.com",
      databaseURL: "https://fall-dectation-default-rtdb.firebaseio.com/",
      projectId: "fall-dectation",
      storageBucket: "fall-dectation.appspot.com",
      messagingSenderId: "467192692594",
      appId: "1:467192692594:web:2756ad46d7d1fbb210e7eb"
    };

    // Init Firebase
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    let map;
    let marker;

    // Init Google Map
    function initMap(lat = 0, lng = 0) {
      const location = { lat: lat, lng: lng };
      map = new google.maps.Map(document.getElementById("map"), {
        zoom: 15,
        center: location
      });
      marker = new google.maps.Marker({
        position: location,
        map: map,
        title: "Elderly Person Location"
      });
    }

    // Update Map
    function updateMap(lat, lng) {
      const location = { lat: lat, lng: lng };
      map.setCenter(location);
      marker.setPosition(location);
    }

    // Listen for new alerts
    database.ref("/alerts").limitToLast(1).on("child_added", function(snapshot) {
      const data = snapshot.val();
      document.getElementById("type").innerText = data.type;
      document.getElementById("lat").innerText = data.lat;
      document.getElementById("lng").innerText = data.lng;
      document.getElementById("battery").innerText = data.battery;

      updateMap(data.lat, data.lng);
    });
  </script>

  <!-- Google Maps API -->
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC-7Z9ZeLKoCIn5eV6vsSIH_bKMAq80l20&callback=initMap"
          async defer></script>
</body>
</html>
